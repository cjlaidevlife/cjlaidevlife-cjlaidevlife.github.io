<!doctype html><html lang=en data-bs-theme=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg="></script><link rel=stylesheet href=/main.2ba05d73b2b15569a4aa9cf598b60f90bff89864bca9601ac523aecf56e198931e068aa6ed06afaf3b73c28b8b4eaa68da4bff6385d13b53602ecf1609bcafff.css integrity="sha512-K6Bdc7KxVWmkqpz1mLYPkL/4mGS8qWAaxSOuz1bhmJMeBoqm7QavrztzwouLTqpo2kv/Y4XRO1NgLs8WCbyv/w==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><link rel=canonical href=/blog/rhel8.5%E5%AE%89%E8%A3%9Ddocker%E5%B0%8F%E7%AD%86%E8%A8%98/><title>RHEL8.5安裝Docker小筆記 | 芥末轟炸雞の手帳</title><meta name=description content="其實就是看我如何在RHEL8安裝Docker。"><link rel=icon href=/favicon-16x16.png sizes=16x16 type=image/png><link rel=icon href=/favicon-32x32.png sizes=32x32 type=image/png><link rel=icon href=/favicon-150x150.png sizes=150x150 type=image/png><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180 type=image/png><link rel=icon href=/favicon-192x192.png sizes=192x192 type=image/png><link rel=icon href=/favicon-512x512.png sizes=512x512 type=image/png><link rel=icon href=/favicon.svg><link rel=mask-icon href=/mask-icon.svg color=white><meta property="og:title" content="RHEL8.5安裝Docker小筆記"><meta property="og:description" content="其實就是看我如何在RHEL8安裝Docker。"><meta property="og:type" content="article"><meta property="og:url" content="/blog/rhel8.5%E5%AE%89%E8%A3%9Ddocker%E5%B0%8F%E7%AD%86%E8%A8%98/"><meta property="og:image" content="/cover.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2023-11-18T13:13:56+08:00"><meta property="article:modified_time" content="2023-11-18T13:13:56+08:00"><meta property="og:site_name" content="My Docs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/cover.png"><meta name=twitter:title content="RHEL8.5安裝Docker小筆記"><meta name=twitter:description content="其實就是看我如何在RHEL8安裝Docker。"><meta name=twitter:site content="@getdoks"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"/","name":"芥末轟炸雞の手帳","position":1},{"@type":"ListItem","item":"/blog/","name":"Blog","position":2},{"@type":"ListItem","name":"Rhel8.5安裝 Docker小筆記","position":3}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"BlogPosting","headline":"RHEL8.5安裝Docker小筆記","description":"其實就是看我如何在RHEL8安裝Docker。","isPartOf":{"@id":"/blog/rhel8.5%E5%AE%89%E8%A3%9Ddocker%E5%B0%8F%E7%AD%86%E8%A8%98/"},"mainEntityOfPage":{"@id":"/blog/rhel8.5%E5%AE%89%E8%A3%9Ddocker%E5%B0%8F%E7%AD%86%E8%A8%98/"},"datePublished":"2023-11-18T13:13:56+08:00","dateModified":"2023-11-18T13:13:56+08:00","image":[{"@id":"/blog/rhel8.5%E5%AE%89%E8%A3%9Ddocker%E5%B0%8F%E7%AD%86%E8%A8%98/images/rhel_subscription-manager.jpg"}],"author":{"@type":"Organization","name":"Hyas","url":"/"},"publisher":{"@type":"Organization","name":"Hyas"}}]}</script></head><body class="single section blog" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div class=sticky-top><header class="navbar navbar-expand-lg"><div class=container-lg><a class="navbar-brand me-auto me-lg-3" href=/>芥末轟炸雞の手帳</a>
<button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>芥末轟炸雞の手帳</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class=nav-link href=/docs/guides/example-guide/>Docs</a></li><li class=nav-item><a class="nav-link active" href=/blog/ aria-current=true>Blog</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button id=buttonColorMode class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type=button aria-label="Toggle theme"><svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/></svg><svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://github.com/cjlaidevlife><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul></div></div></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=utf-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class="submitted d-none"><time class=created-date>Date here</time></div></header><div class=content>Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-lg" role=document><div class=content><article><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><div class=blog-header><h1>RHEL8.5安裝Docker小筆記</h1><p><small>November 18, 2023&nbsp;in&nbsp;<a class="stretched-link position-relative link-muted" href=/categories/note/>Note</a><span class="stretched-link position-relative reading-time" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 7v5l3 3"/></svg>4&nbsp;minutes</span></small></p></div></div><div class="col-md-12 col-lg-9"><p class=lead>嘗試在RHEL8上安裝Docker時發現沒有想像中來的順利😢，所以決定寫這篇來記錄這個過程。實際上本篇會遵照Docker官網 Install Docker Engine on RHEL循序安裝與說明，不過並非Step By Step的教學會夾雜一些故障排除，所以也可以直接去看官網會比較快。</p><div class="callout callout-note d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3"><svg class="info-circle svg-inline callout-icon me-2 mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 9h.01"/><path d="M11 12h1v4h1"/></svg><div class=callout-content><div class=callout-body><p>這篇文章來自於2022年5月，我發佈在HashNode平台的一篇同名文章 。因為沒有經營Hashnode，所以乾脆直接拉回來放一起管理。</p></div></div></div><p>ref: RHEL8.5安裝Docker小筆記<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h1 id=1-環境說明>1. 環境說明</h1><p>實驗主機的環境是Windows 11，所以需要使用到VirtualBox這個虛擬化解決方案 ，來達成我的目的。手邊如果沒有RHEL作業系統映像檔，可以自行前往Redhat Developer<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>下載DVD iso檔來安裝。</p><ul><li>VirtualBox: 6.1.30</li><li>RHEL: 8.5</li></ul><h1 id=2-安裝docker>2. 安裝Docker</h1><h2 id=21-設置yum-repository>2.1 設置Yum Repository</h2><p>原先我是採用yum.repo去指向掛載的dvd.iso，用這個方式來安裝Yum Repository管理套件。但是發現DVD抓不到yum-utils這個套件，並且出現下面錯誤。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yum install -y yum-utils
</span></span><span class=line><span class=cl><span class=c1>#Updating Subscription Management repositories.</span>
</span></span><span class=line><span class=cl><span class=c1>#DVD for RHEL8 BaseOs                                                                                                                                        0.0  B/s |   0  B     00:00</span>
</span></span><span class=line><span class=cl><span class=c1>#Errors during downloading metadata for repository &#39;DVD-BaseOS&#39;:</span>
</span></span><span class=line><span class=cl><span class=c1>#  - Curl error (37): Couldn&#39;t read a file:// file for file:///mnt/dvd/BaseOS/repodata/repomd.xml [Couldn&#39;t open file /mnt/dvd/BaseOS/repodata/repomd.xml]</span>
</span></span><span class=line><span class=cl><span class=c1>#Error: Failed to download metadata for repo &#39;DVD-BaseOS&#39;: Cannot download repomd.xml: Cannot download repodata/repomd.xml: All mirrors were tried</span>
</span></span></code></pre></div><p>找了好久，真的很不熟RHEL的生態&mldr;所以決定找時間再研究這個議題。為了解決上述這個問題的方式，可以透過下面3個步驟來解決:</p><div class="callout callout-caution d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3"><svg class="info-triangle svg-inline callout-icon me-2 mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10.363 3.591 2.257 17.125a1.914 1.914.0 001.636 2.871h16.214a1.914 1.914.0 001.636-2.87L13.637 3.59a1.914 1.914.0 00-3.274.0z"/><path d="M12 9h.01"/><path d="M11 12h1v4h1"/></svg><div class=callout-content><div class=callout-body><p>前提是機器的網路可以對外連線，若無法對外連線則需要透過其它方式。</p></div></div></div><h3 id=註冊redhat-developer帳號>註冊RedHat Developer帳號</h3><p>查詢的過程中，發現其實RedHat有提供No-cost RHEL for developers subscription<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>，所以我立馬去註冊一組帳號來試試。下圖是我菜味十足的訂閱資訊:</p><p><img alt="developers subscription" class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/blog/rhel8.5%E5%AE%89%E8%A3%9Ddocker%E5%B0%8F%E7%AD%86%E8%A8%98/images/rhel_subscription-manager_huc5d6c5e7be077dba0d49a40089c798b5_31820_4ed20e58d277e8f0867467413a739f58.webp 480w, /blog/rhel8.5%E5%AE%89%E8%A3%9Ddocker%E5%B0%8F%E7%AD%86%E8%A8%98/images/rhel_subscription-manager_huc5d6c5e7be077dba0d49a40089c798b5_31820_43c252ca9a12c1717e6731e6c97aea63.webp 640w, /blog/rhel8.5%E5%AE%89%E8%A3%9Ddocker%E5%B0%8F%E7%AD%86%E8%A8%98/images/rhel_subscription-manager_huc5d6c5e7be077dba0d49a40089c798b5_31820_5852542eb50ccfbb85fe6584231d30d8.webp 800w, /blog/rhel8.5%E5%AE%89%E8%A3%9Ddocker%E5%B0%8F%E7%AD%86%E8%A8%98/images/rhel_subscription-manager_huc5d6c5e7be077dba0d49a40089c798b5_31820_2d1e99d13326c860c28deb44034704b0.webp 1024w" fetchpriority=low height=765 id=h-rh-i-0 src=/blog/rhel8.5%E5%AE%89%E8%A3%9Ddocker%E5%B0%8F%E7%AD%86%E8%A8%98/images/rhel_subscription-manager_huc5d6c5e7be077dba0d49a40089c798b5_31820_b740abb4a0a068ee5b26f5aadfe91a0b.webp width=1360></p><h3 id=啟用機器的rhel訂閱>啟用機器的RHEL訂閱</h3><p>至於啟用機器訂閱的方式則可以透過Registration Assistant<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>這個服務，產生出對應的指令。本次我使用到下面這串指令完成了我的訂閱:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>subscription-manager register --username &lt;username&gt; --password &lt;password&gt;
</span></span><span class=line><span class=cl>subscription-manager list
</span></span></code></pre></div><h3 id=重新下載yum-utils>重新下載yum-utils</h3><p>再次執行一開始的指令Complete!!!終於順利完成下載了!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yum install -y yum-utils
</span></span><span class=line><span class=cl>sudo yum list --installed <span class=p>|</span>grep -i yum-utils
</span></span><span class=line><span class=cl><span class=c1>#yum-utils.noarch             4.0.21-4.el8_5              @rhel-8-for-x86_64-baseos-rpms</span>
</span></span></code></pre></div><p>解決註冊問題後，我們可以繼續配置安裝Docker套件所需要的設定:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yum-config-manager <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--add-repo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>https://download.docker.com/linux/rhel/docker-ce.repo
</span></span><span class=line><span class=cl>sudo yum repolist
</span></span><span class=line><span class=cl><span class=c1>#Updating Subscription Management repositories.</span>
</span></span><span class=line><span class=cl><span class=c1>#repo id                                                                           repo name</span>
</span></span><span class=line><span class=cl><span class=c1>#docker-ce-stable                                                                  Docker CE Stable - x86_64</span>
</span></span><span class=line><span class=cl><span class=c1>#rhel-8-for-x86_64-appstream-rpms                                                  Red Hat Enterprise #Linux 8 for x86_64 - AppStream (RPMs)</span>
</span></span><span class=line><span class=cl><span class=c1>#rhel-8-for-x86_64-baseos-rpms                                                     Red Hat Enterprise #Linux 8 for x86_64 - BaseOS (RPMs)</span>
</span></span></code></pre></div><div class="callout callout-note d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3"><svg class="info-circle svg-inline callout-icon me-2 mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 9h.01"/><path d="M11 12h1v4h1"/></svg><div class=callout-content><div class=callout-body><p>這裡可以透過&ndash;enable去開啟特殊版本(nightly、test)的套件，但這邊可以先不需要理會。</p></div></div></div><h2 id=22-安裝docker套件>2.2 安裝Docker套件</h2><p>設置好repo可以開始進入主題，下載docker&mldr;.等等，若是不指定版本基本上都會是下載latest版本的套件，不過個人習慣先確認好版本，所以會執行下列指令:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yum list docker-ce --showduplicates <span class=p>|</span> sort -r
</span></span><span class=line><span class=cl><span class=c1>#Errors during downloading metadata for repository &#39;docker-ce-stable&#39;:</span>
</span></span><span class=line><span class=cl><span class=c1>#  - Status code: 404 for https://download.docker.com/linux/rhel/8/x86_64/stable/repodata/repomd.xml (IP: 13.35.166.118)</span>
</span></span><span class=line><span class=cl><span class=c1>#Error: Failed to download metadata for repo &#39;docker-ce-stable&#39;: Cannot download repomd.xml: Cannot download repodata/repomd.xml: All mirrors were tried</span>
</span></span><span class=line><span class=cl><span class=c1>#Updating Subscription Management repositories.</span>
</span></span><span class=line><span class=cl><span class=c1>#Docker CE Stable - x86_64                       337  B/s | 381  B     00:01</span>
</span></span></code></pre></div><p>你沒看錯，又遇到問題了。檢查一下官網文件<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>後發現原來是自己眼拙，其實最開始的Note就有提到:</p><blockquote><p>We currently only provide packages for RHEL on s390x (IBM Z). Other architectures are not yet supported for RHEL, but you may be able to install the CentOS packages on RHEL. Refer to the Install Docker Engine on CentOS page for details.</p><p>from &ldquo;Install Docker Engine on RHEL 2022.03.06&rdquo;</p></blockquote><p>所以2.1 設置Yum Repository中，配置安裝Docker套件所需要的設定，只要從指向RHEL Repository改為從CentOS Repository拉取套件就可以:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yum-config-manager <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--add-repo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>https://download.docker.com/linux/centos/docker-ce.repo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>yum list docker-ce --showduplicates <span class=p>|</span> sort -r
</span></span><span class=line><span class=cl><span class=c1>#Updating Subscription Management repositories.</span>
</span></span><span class=line><span class=cl><span class=c1>#docker-ce.x86_64                3:20.10.9-3.el8                 docker-ce-stable</span>
</span></span><span class=line><span class=cl><span class=c1>#       ...                          ...                              ...</span>
</span></span><span class=line><span class=cl><span class=c1>#Docker CE Stable - x86_64                        56 kB/s |  20 kB     00:00</span>
</span></span><span class=line><span class=cl><span class=c1>#Available Packages</span>
</span></span></code></pre></div><p>確認好版本後，安裝Docker我們需要3個套件: docker-ce、docker-ce-cli、containerd.io，這次也是十分爭氣的遇到錯誤(很長一串所以我刪掉&mldr;一些):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yum install -y docker-ce-3:20.10.9-3.el8 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>docker-ce-cli-1:20.10.9-3.el8 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>containerd.io
</span></span><span class=line><span class=cl><span class=c1>#Updating Subscription Management repositories.</span>
</span></span><span class=line><span class=cl><span class=c1>#Last metadata expiration check: 0:41:05 ago on Sun 06 Mar 2022 09:19:20 PM CST.</span>
</span></span><span class=line><span class=cl><span class=c1>#Error:</span>
</span></span><span class=line><span class=cl><span class=c1># Problem 1: problem with installed package podman-1:3.4.2-9.module+el8.5.0+13852+150547f7.x86_64</span>
</span></span><span class=line><span class=cl><span class=c1># Problem 2: problem with installed package podman-catatonit-1:3.4.2-9.module+el8.5.0+13852+150547f7.x86_64</span>
</span></span></code></pre></div><p>原來我又粗心了，以為新的作業系統就不會有套件衝突問題，原來RHEL8.5預設會安裝podman、runc，套件間會產生衝突。所以這次為了保守起見，我全部移除後再重新安裝，這次終於沒有怪怪的訊息了:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 移除套件</span>
</span></span><span class=line><span class=cl>sudo yum remove docker <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>docker-client <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>docker-client-latest <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>docker-common <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>docker-latest <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>docker-latest-logrotate <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>docker-logrotate <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>docker-engine <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>podman <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>runc
</span></span></code></pre></div><p>再次安裝理論上會順利出現久違的Complete!!!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yum install -y docker-ce-3:20.10.9-3.el8 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>docker-ce-cli-1:20.10.9-3.el8 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>containerd.io
</span></span></code></pre></div><h2 id=23-啟動docker-engine>2.3 啟動Docker Engine</h2><p>這次十分順利的啟動Docker:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl start docker
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> docker
</span></span></code></pre></div><p>如果想再確認一下是否成功，可以檢查systemd是否正常運作:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl status docker
</span></span><span class=line><span class=cl><span class=c1>#● docker.service - Docker Application Container Engine</span>
</span></span><span class=line><span class=cl> <span class=c1>#  Loaded: loaded (/usr/lib/systemd/system/docker.service; enabled; vendor preset: disabled)</span>
</span></span><span class=line><span class=cl><span class=c1>#   Active: active (running) since Mon 2022-03-07 13:23:51 CST; 1min 25s ago</span>
</span></span><span class=line><span class=cl><span class=c1>#     Docs: https://docs.docker.com</span>
</span></span><span class=line><span class=cl><span class=c1># Main PID: 1183 (dockerd)</span>
</span></span><span class=line><span class=cl><span class=c1>#    Tasks: 7</span>
</span></span><span class=line><span class=cl><span class=c1>#   Memory: 131.4M</span>
</span></span><span class=line><span class=cl><span class=c1>#   CGroup: /system.slice/docker.service</span>
</span></span><span class=line><span class=cl><span class=c1>#           └─1183 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span>
</span></span></code></pre></div><h1 id=3-測試docker基本功能>3. 測試Docker基本功能</h1><p>我們可以嘗試做一些docker指令來驗證docker服務是否正常。不過，本篇主要是紀錄如何安裝Docker，所以接下來並不會做過多的說明:</p><h2 id=31-檢查docker版本>3.1 檢查Docker版本</h2><p>這裡顯示的Docker版本資訊，會根據安裝的版本不同而有所差異。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker --version
</span></span><span class=line><span class=cl><span class=c1># Docker version 20.10.9, build c2ea9bc</span>
</span></span></code></pre></div><h2 id=32-執行docker容器>3.2 執行Docker容器</h2><p>我們可以找個簡單的image來執行。特別提到Docker在本地沒有找到符合名字的image時，則會去Docker Hub抓對應的image下來。所以，如果RHEL8.5沒有對外網路連線，出現錯誤訊息是正常的歐~</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -p 80:80 -d nginx
</span></span><span class=line><span class=cl><span class=c1>#Unable to find image &#39;nginx:latest&#39; locally</span>
</span></span><span class=line><span class=cl><span class=c1>#latest: Pulling from library/nginx</span>
</span></span><span class=line><span class=cl><span class=c1>#f7a1c6dad281: Pull complete</span>
</span></span><span class=line><span class=cl><span class=c1>#4d3e1d15534c: Pull complete</span>
</span></span><span class=line><span class=cl><span class=c1>#9ebb164bd1d8: Pull complete</span>
</span></span><span class=line><span class=cl><span class=c1>#59baa8b00c3c: Pull complete</span>
</span></span><span class=line><span class=cl><span class=c1>#a41ae70ab6b4: Pull complete</span>
</span></span><span class=line><span class=cl><span class=c1>#e3908122b958: Pull complete</span>
</span></span><span class=line><span class=cl><span class=c1>#Digest: #sha256:1c13bc6de5dfca749c377974146ac05256791ca2fe1979fc8e8278bf0121d285</span>
</span></span><span class=line><span class=cl><span class=c1>#Status: Downloaded newer image for nginx:latest</span>
</span></span><span class=line><span class=cl><span class=c1>#b107a9214cbf0bfe53c2a97c56e28540858138d091efbc3ff9e4dcb8c3afc788</span>
</span></span></code></pre></div><h2 id=33-確認docker執行的服務>3.3 確認Docker執行的服務</h2><p>我們執行的Container是Nginx，如果把Port轉發到本地則可以訪問預設的Nginx服務。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker ps
</span></span><span class=line><span class=cl><span class=c1>#CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS                               #NAMES</span>
</span></span><span class=line><span class=cl><span class=c1>#b107a9214cbf   nginx     &#34;/docker-entrypoint.…&#34;   5 seconds ago   Up 4 seconds   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   priceless_curie</span>
</span></span><span class=line><span class=cl>curl http://localhost:80
</span></span><span class=line><span class=cl><span class=c1>#&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;html&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;head&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;style&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#html { color-scheme: light dark; }</span>
</span></span><span class=line><span class=cl><span class=c1>#body { width: 35em; margin: 0 auto;</span>
</span></span><span class=line><span class=cl><span class=c1>#font-family: Tahoma, Verdana, Arial, sans-serif; }</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;/style&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;/head&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;body&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;p&gt;If you see this page, the nginx web server is successfully installed and</span>
</span></span><span class=line><span class=cl><span class=c1>#working. Further configuration is required.&lt;/p&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#&lt;p&gt;For online documentation and support please refer to</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;a href=&#34;http://nginx.org/&#34;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#Commercial support is available at</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;a href=&#34;http://nginx.com/&#34;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;/body&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#&lt;/html&gt;</span>
</span></span></code></pre></div><h1 id=4-總結>4. 總結</h1><p>RHEL8.5環境下，比起安裝Docker CE，Container操作更推薦直接使用Podman、Skopeo跟Buildah，因為DVD.iso已經有提供了(誤)。雖然兩者有些微的不同，不過大致上都是符合OCI(Open Container Initiative)<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>標準。整篇實作下來，Docker官網文件<sup id=fnref1:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>寫得蠻清楚，步驟的安排也有考量到許多細節，值得所有會接觸到Docker的朋友看一看。</p><p>幸好我比較粗心，所以這篇的篇幅才能拉這麼長😂除了碩士論文以外，第一次寫這麼長的文章，如果有任何建議，歡迎各位朋友不吝指教。當然有新手疑問也可以直接來詢問，我十分希望可以藉由這種互動的方式，優化、補強自己不足的地方。感謝各位看倌的收看~下次見🖐</p><h1 id=5-參考資料>5. 參考資料</h1><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://codingfrank.hashnode.dev/dockeronrhel85fornew>RHEL8.5安裝Docker小筆記</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://developers.redhat.com/products/rhel/download>Redhat Developer</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://developers.redhat.com/products/rhel/download>No-cost RHEL for developers subscription</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://access.redhat.com/labs/registrationassistant/>Registration Assistant</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a href=https://docs.docker.com/engine/install/rhel/>Install Docker Engine on RHEL</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a href=https://opencontainers.org/about/overview/>OCI(Open Container Initiative)</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><div class=tag-list-single><a class="btn btn-light" href=/tags/job/ role=button>Job</a>
<a class="btn btn-light" href=/tags/docker/ role=button>Docker</a>
<a class="btn btn-light" href=/tags/linux/ role=button>Linux</a></div></div></div></article></div></div><footer class="footer text-muted"><div class=container-lg><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=/privacy/>Privacy Policy</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=/js/app.1e84dcdaa5ccef6fe83f6d88ac1e444a1f237111cfa2a7a97427f758e9c27ef4.js integrity="sha256-HoTc2qXM72/oP22IrB5ESh8jcRHPoqepdCf3WOnCfvQ="></script><script async src=/js/flexsearch.78e4b7a9456a2770bd6faffb1f6488b30db12ca157c3df4e89e3ae2e258888ae.js integrity="sha256-eOS3qUVqJ3C9b6/7H2SIsw2xLKFXw99OieOuLiWIiK4="></script><script async src=/js/search-modal.c4c023efcdee308e4b5f1110afe1db6b1656f217e67aa7efe54e2f4bf2feccf8.js integrity="sha256-xMAj783uMI5LXxEQr+HbaxZW8hfmeqfv5U4vS/L+zPg="></script></body></html>