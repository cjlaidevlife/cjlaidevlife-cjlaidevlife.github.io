<!doctype html><html lang=en data-bs-theme=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg="></script><link rel=stylesheet href="/main.2ffcf7cd79999b39df45c98db10526e8fda7ee5f65f4daade3e147c16bb8a5d026349acf2596a442cd35935ee9a28a37291ef32453717bfbc376d79bcf3a3f50.css" integrity="sha512-L/z3zXmZmznfRcmNsQUm6P2n7l9l9Nqt4+FHwWu4pdAmNJrPJZakQs01k17pooo3KR7zJFNxe/vDdtebzzo/UA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><base href=/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/><link rel=canonical href=/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/><title>在VS Code上查詢MSSQL的sqlaudit檔案 | 芥末轟炸雞の手帳</title>
<meta name=description content="本來以為很簡單，但事實上並不單純的讀取sqlaudit內容之旅"><link rel=icon href=/favicon.ico sizes=32x32><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180 type=image/png><link rel=icon href=/favicon-192x192.png sizes=192x192 type=image/png><link rel=icon href=/favicon-512x512.png sizes=512x512 type=image/png><link rel=manifest href=/manifest.webmanifest><meta property="og:title" content="在VS Code上查詢MSSQL的sqlaudit檔案"><meta property="og:description" content="本來以為很簡單，但事實上並不單純的讀取sqlaudit內容之旅"><meta property="og:type" content="article"><meta property="og:url" content="/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/"><meta property="og:image" content="/cover.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-06-05T22:28:37+08:00"><meta property="article:modified_time" content="2024-06-05T22:28:37+08:00"><meta property="og:site_name" content="My Docs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/cover.png"><meta name=twitter:title content="在VS Code上查詢MSSQL的sqlaudit檔案"><meta name=twitter:description content="本來以為很簡單，但事實上並不單純的讀取sqlaudit內容之旅"><meta name=twitter:site content="@cjlai"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"/","name":"芥末轟炸雞の手帳","position":1},{"@type":"ListItem","item":"/blog/","name":"Blog","position":2},{"@type":"ListItem","name":"在 vs Code上查詢 Mssql的sqlaudit檔案","position":3}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"BlogPosting","headline":"在VS Code上查詢MSSQL的sqlaudit檔案","description":"本來以為很簡單，但事實上並不單純的讀取sqlaudit內容之旅","isPartOf":{"@id":"/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/"},"mainEntityOfPage":{"@id":"/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/"},"datePublished":"2024-06-05T22:28:37+08:00","dateModified":"2024-06-05T22:28:37+08:00","image":[{"@id":"/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/images/connection_mssql.png"},{"@id":"/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/images/connection_mssql_success.png"},{"@id":"/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/images/install_sql_server_extension.png"},{"@id":"/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/images/query_sqlaudit_success.png"},{"@id":"/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/images/sqlaudit_file_row_content.png"},{"@id":"/blog/%E5%9C%A8vs-code%E4%B8%8A%E6%9F%A5%E8%A9%A2mssql%E7%9A%84sqlaudit%E6%AA%94%E6%A1%88/images/use_hex_tool_decoded.png"}],"author":{"@type":"Organization","name":"Hyas","url":"/"},"publisher":{"@type":"Organization","name":"Hyas"}}]}</script></head><body class="single section blog" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div class=sticky-top><header class="navbar navbar-expand-lg"><div class=container-lg><a class="navbar-brand me-auto me-lg-3" href=/>芥末轟炸雞の手帳</a>
<button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
</button>
<button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>芥末轟炸雞の手帳</h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class=nav-link href=/docs/guides/example-guide/>Docs</a></li><li class=nav-item><a class="nav-link active" href=/blog/ aria-current=true>Blog</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website">
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
</button>
<button id=buttonColorMode class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type=button aria-label="Toggle theme"><svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/></svg><svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://github.com/cjlaidevlife><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul></div></div></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=UTF-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class="submitted d-none"><time class=created-date>Date here</time></div></header><div class=content>Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-lg" role=document><div class=content><article><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><div class=blog-header><h1>在VS Code上查詢MSSQL的sqlaudit檔案</h1><p><small>June 5, 2024&nbsp;in&nbsp;<a class="stretched-link position-relative link-muted" href=/categories/note/>Note</a><span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 7v5l3 3"/></svg>1&nbsp;minute</span></small></p></div></div><div class="col-md-12 col-lg-9"><p class=lead>本來以為很簡單，但事實上並不單純的讀取sqlaudit內容之旅。這個議題是工作上遇到需要讀取sqlaudit檔案，但是我並不熟悉MSSQL，所以藉由ChatGPT輔助，針對解答與自己的想法整理出來的筆記。</p><h1 id=1-背景>1. 背景</h1><p>直接打開從MSSQL備份下來的<code>*.sqlaudit</code>檔案，會因為該檔案經過MSSQL編碼過，而出現無法直接識別的亂碼文件。</p><details><summary>(Click Me) MSQL SQLAudit File Row Content</summary><img src=./images/sqlaudit_file_row_content.png alt="MSQL SQLAudit File Row Content"></details><hr><h1 id=2-前置條件>2. 前置條件</h1><p>若要查看<code>*.sqlaudit</code>的內容，需要符合下列條件:</p><ol><li><p>查詢MSSQL的編輯器<br>可以參考官方提供的工具<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>，例如: SQL Server Management Studio、Azure Data Studio，或是透過vscode安裝mssql extension<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>。</p></li><li><p>Microsoft SQL Server<br>除了手邊既有的mssql，推薦可以透過docker建立一座臨時的mssql container。</p></li></ol><hr><h1 id=3-解決方式>3. 解決方式</h1><h2 id=3-1>3.1 低成本取得MSSQL</h2><div class="callout callout-tip d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3"><svg class="outline/rocket svg-inline callout-icon me-2 mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 13a8 8 0 017 7 6 6 0 003-5 9 9 0 006-8 3 3 0 00-3-3 9 9 0 00-8 6 6 6 0 00-5 3"/><path d="M7 14a6 6 0 00-3 6 6 6 0 006-3"/><path d="M15 9m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg><div class=callout-content><div class=callout-title><p>Why Use a Container?</p></div><div class=callout-body><p>透過docker container的技術，我們可以減少取得測試用資料庫所需的成本。</p></div></div></div><p>首先將下面yaml格式的內容存成<code>docker-compose.yml</code>:</p><div class=expressive-code><figure class="frame has-title not-content"><figcaption class=header><span class=title>docker-compose.yml</span></figcaption><div class=highlight title=docker-compose.yml><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class="line hl"><span class=ln> 1</span><span class=cl><span class=c># Version: &#34;3.9&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w>  </span><span class=nt>db</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>mcr.microsoft.com/mssql/server:2019-latest</span><span class=w>
</span></span></span><span class="line hl"><span class=ln> 5</span><span class=cl><span class=w>    </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>linux/amd64</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>      </span>- <span class=s2>&#34;1433:1433&#34;</span><span class=w>
</span></span></span><span class="line hl"><span class=ln> 8</span><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>      </span>- <span class=l>.:/auditfiles</span><span class=w>
</span></span></span><span class="line hl"><span class=ln>10</span><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>      </span><span class=nt>ACCEPT_EULA</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Y&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>      </span><span class=nt>SA_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Passw0rd&#34;</span></span></span></code></pre></div></figure></div><ul><li><strong>version</strong>: 內容會將他註解掉是因為，docker最新的官方文件已經將version這個element標示為obsolete<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>，考量到有些沒有更新的docker compose的使用者而以註解的形式保留。</li><li><strong>platform</strong>: 這個設定並非必要，主要是我在執行時所使用的設備是arm cpu，所以需要指定platform<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>。</li><li><strong>volumes</strong>: 會掛載當前路徑到container內，所以<code>*.sqlaudit</code>檔案也需要放在當前目錄下。</li><li><strong>environment</strong>: 在Linux上可以設定的mssql環境變數可以參考官網文件<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>。</li></ul><p>接下來只需要透過docker compose的指令就可以取得測試用資料庫:</p><div class=expressive-code><figure class="frame is-terminal has-title not-content"><figcaption class=header><span class=title>bash</span></figcaption><div class=highlight title=bash><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>docker compose up -d</span></span></code></pre></div></figure></div><hr><h2 id=32-透過vs-code連線到mssql>3.2 透過VS Code連線到MSSQL</h2><div class="callout callout-tip d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3"><svg class="outline/rocket svg-inline callout-icon me-2 mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 13a8 8 0 017 7 6 6 0 003-5 9 9 0 006-8 3 3 0 00-3-3 9 9 0 00-8 6 6 6 0 00-5 3"/><path d="M7 14a6 6 0 00-3 6 6 6 0 006-3"/><path d="M15 9m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg><div class=callout-content><div class=callout-title><p>Why Use a VS Code?</p></div><div class=callout-body><p>因為筆者目前還是習慣在vs code執行各項作業，所以工具選型才會是透過vs code + extension的方式進行。如果手邊有SSMS或其他工具可以連線到MSSQL，那就可以忽略這個小節。</p></div></div></div><p>安裝僅需要打開vscode找到MSSQL的extension<sup id=fnref1:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，按下install即可:</p><img src=./images/install_sql_server_extension.png alt="Install SQL Server Extension on VS Cod"><p>接下來可以嘗試連線到步驟<a href=#3-1>3.1 低成本取得MSSQL</a>所建立的資料庫:</p><div class="callout callout-note d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3"><svg class="outline/info-circle svg-inline callout-icon me-2 mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 9h.01"/><path d="M11 12h1v4h1"/></svg><div class=callout-content><div class=callout-body><p>除了hostname是連線到localhost以外，剩下的設定都是依照步驟<a href=#3-1>3.1 低成本取得MSSQL</a>，啟動資料庫時傳入的參數而定。</p></div></div></div><img src=./images/connection_mssql.png alt="Open The VS Code Command Palette and Type MSSQL Connction Info"><p>登入成功就可以得到如下圖紅匡標示的結果:</p><img src=./images/connection_mssql_success.png alt="Connection MSSQL Success Pane"><hr><h2 id=33-直接在vs-code上讀取sqlaudit檔>3.3 直接在VS Code上讀取sqlaudit檔</h2><div class="callout callout-caution d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3"><svg class="outline/info-triangle svg-inline callout-icon me-2 mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10.363 3.591 2.257 17.125a1.914 1.914.0 001.636 2.871h16.214a1.914 1.914.0 001.636-2.87L13.637 3.59a1.914 1.914.0 00-3.274.0z"/><path d="M12 9h.01"/><path d="M11 12h1v4h1"/></svg><div class=callout-content><div class=callout-body><p>這邊要注意sqlaudit的檔案位置是我們透過docker volume的方式，將<code>*.sqlaudit</code>檔案所在路徑mount到mssql的container內。</p></div></div></div><div class=expressive-code><figure class="frame has-title not-content"><figcaption class=header><span class=title>sql</span></figcaption><div class=highlight title=sql><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class="line hl"><span class=ln>1</span><span class=cl><span class=k>DECLARE</span><span class=w> </span><span class=o>@</span><span class=n>filePath</span><span class=w> </span><span class=n>NVARCHAR</span><span class=p>(</span><span class=mi>260</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>N</span><span class=s1>&#39;/auditfiles/xxx.sqlaudit&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>sys</span><span class=p>.</span><span class=n>fn_get_audit_file</span><span class=p>(</span><span class=o>@</span><span class=n>filePath</span><span class=p>,</span><span class=w> </span><span class=k>DEFAULT</span><span class=p>,</span><span class=w> </span><span class=k>DEFAULT</span><span class=p>);</span></span></span></code></pre></div></figure></div><p>完成後查詢結果大約會像下圖所示:</p><img src=./images/query_sqlaudit_success.png alt="Reading MSSQL SQLAudit File Success"><hr><h1 id=4-總結>4. 總結</h1><p>撰寫這篇文章時，內心其實有點猶豫。雖然有ChatGPT可以輔助，但要將這次內容的知識點逐一點到說明真的很困難!這次使用的解決方法有需多前置的知識需要了解，例如: Docker Compose是什麼?VS Code怎麼用&mldr;等等。</p><p>寫到後面發現這篇文章的定位十分尷尬。對於新手來說，很容易被多個不同技術繞到頭暈目眩;對於老手來說，這篇文章解決的議題又太過沒有深度。所以這篇就當作是練練手，後續再持續找時間優化它吧。</p><p>最後有發現，其實也可以透Hex Editor<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>之類的工具去確認編碼，然後再轉成可讀取的編碼就好，但是內容格式有點難讀就是了。這篇文章暫時就不追那麼深，希望未來有機會再去往下探索，感謝各位看官收看，希望有機會收到更多的回饋，謝謝。</p><img src=./images/use_hex_tool_decoded.png alt="Reading MSSQL SQLAudit File By Hex Editor"><hr><h1 id=5-參考資料>5. 參考資料</h1><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href="https://learn.microsoft.com/zh-tw/sql/sql-server/connect-to-database-engine?view=sql-server-ver16">連線到 SQL Server 資料庫引擎 - SQL Server | Microsoft Learn</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href="https://marketplace.visualstudio.com/items?itemName=ms-mssql.mssql">Visual Studio Market Place SQL Server (mssql)</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://docs.docker.com/compose/compose-file/04-version-and-name/#version-top-level-element-obsolete>Version top-level element (obsolete)</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href="https://docs.docker.com/compose/compose-file/05-services/?highlight=platforms#platform">Services top-level elements-platforms</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a href="https://learn.microsoft.com/zh-tw/sql/linux/sql-server-linux-configure-environment-variables?view=sql-server-ver16">使用環境變數在 Linux 上設定 SQL Server 設定</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.hexeditor">Visual Studio Market Place Hex Editor</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><div class=tag-list-single><a class="btn btn-light" href=/tags/job/ role=button>Job</a>
<a class="btn btn-light" href=/tags/docker/ role=button>Docker</a>
<a class="btn btn-light" href=/tags/mssql/ role=button>MSSQL</a>
<a class="btn btn-light" href=/tags/vs-code/ role=button>VS Code</a>
<a class="btn btn-light" href=/tags/audit-file/ role=button>Audit File</a></div></div></div></article></div></div><footer class="footer text-muted"><div class=container-lg><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=/privacy/>Privacy Policy</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=/js/app.47b84f3b640408af6efe7bf4add1a36f5b9c6227fbae7b8bcdf0c9ce42fefc54.js integrity="sha256-R7hPO2QECK9u/nv0rdGjb1ucYif7rnuLzfDJzkL+/FQ="></script><script async src=/js/flexsearch.b6f80717bc68cd38b6ded7a061f96a73896db6be17a6582f09a63a6040040919.js integrity="sha256-tvgHF7xozTi23tegYflqc4lttr4XplgvCaY6YEAECRk="></script><script async src=/js/search-modal.4e30271fef6fac86c3b4143167e9784bd3f7037ce1045d03a321e7e799e91476.js integrity="sha256-TjAnH+9vrIbDtBQxZ+l4S9P3A3zhBF0DoyHn55npFHY="></script><div class="d-inline-flex fixed-bottom-right pb-4 pe-4"><button id=toTop type=button class="btn btn-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 15l6-6 6 6"/></svg></button></div></body></html>